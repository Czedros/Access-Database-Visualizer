<Window x:Class="WPF_Visualizer_Temp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WPF_Visualizer_Temp"
        mc:Ignorable="d"
        Title="Access Database Viewer"
        Height="600" Width="900"
        Background="#f0f0f5"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- App Header -->
        <Border Background="#2c3e50" CornerRadius="8" Padding="15" Margin="0,0,0,10">
            <TextBlock Text="Access Database Editor"
                       FontSize="28"
                       FontWeight="Bold"
                       Foreground="White"
                       FontFamily="Georgia"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>
        </Border>

        <!-- File Selection Row -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- Open File Button -->
                <ColumnDefinition Width="*"/>
                <!-- File path text -->
                <ColumnDefinition Width="Auto"/>
                <!-- New Entry Button -->
            </Grid.ColumnDefinitions>

            <!-- Open File Button -->
            <Button Content="Open Access File"
            Width="160"
            Background="#34495e"
            Foreground="White"
            FontWeight="Bold"
            BorderThickness="0"
            Padding="8,4"
            Click="OpenFile_Click"
            Cursor="Hand"
            Grid.Column="0"/>

            <!-- File Path Text -->
            <TextBlock x:Name="FilePathText"
               Margin="160,0,0,0"
               VerticalAlignment="Center"
               Foreground="#2c3e50"
               FontStyle="Italic"
               Grid.Column="1"
               TextTrimming="CharacterEllipsis"
               MaxWidth="400"/>

            <!-- New Entry Button -->
            <Button Content="New Entry"
            Width="120"
            Background="#27ae60"
            Foreground="White"
            FontWeight="Bold"
            Padding="8,4"
            Margin="10,0,0,0"
            Click="NewEntry_Click"
            Cursor="Hand"
            Grid.Column="2"/>
            
        </Grid>

        <!-- Main Display -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220"/>
                <ColumnDefinition Width="22*"/>
                <ColumnDefinition Width="103*"/>
                <ColumnDefinition Width="87*"/>
                <ColumnDefinition Width="428*"/>
            </Grid.ColumnDefinitions>

            <!-- Table List -->
            <Border Grid.Column="0"
                    Background="White"
                    BorderBrush="#bdc3c7"
                    BorderThickness="1"
                    CornerRadius="5"
                    Padding="5"
                    Margin="0,0,10,0"
                    >
                <StackPanel>
                    <DockPanel Margin="0,0,0,5">
                        <TextBlock x:Name="SidebarTitle"
                   Text="Tables"
                   FontWeight="Bold"
                   FontSize="16"
                   Foreground="#2c3e50"
                   DockPanel.Dock="Left"/>
                        <Button Content="📌"
                ToolTip="Toggle Bookmarks"
                Width="30"
                Height="24"
                Margin="5,0,0,0"
                Click="ToggleSidebar_Click"
                DockPanel.Dock="Right"/>
                    </DockPanel>

                    <!-- List for Tables -->
                    <ListBox x:Name="TablesListBox"
                     Background="#ecf0f1"
                     BorderThickness="0"
                     SelectionChanged="TablesListBox_SelectionChanged"
                     SelectionMode="Single">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            </Style>
                        </ListBox.ItemContainerStyle>

                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <DockPanel Margin="0,2" LastChildFill="True" Cursor="Hand">
                                    <!-- Bookmark Button -->
                                    <Button Content="★"
                        Width="25"
                        Height="25"
                        Margin="0,0,5,0"
                        VerticalAlignment="Center"
                        DockPanel.Dock="Left"
                        ToolTip="Bookmark this table"
                        Tag="{Binding}"
                        Click="BookmarkTableFromList_Click"/>

                                    <!-- Table Name -->
                                    <TextBlock Text="{Binding}"
                           VerticalAlignment="Center"
                           FontSize="14"
                           Foreground="#2c3e50"
                           Padding="4"/>
                                </DockPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <!-- List for Bookmarks -->
                    <ListBox x:Name="BookmarksListBox"
                     SelectionChanged="BookmarksListBox_SelectionChanged"
                     Background="#ecf0f1"
                     BorderThickness="0"
                     Height="150">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <DockPanel Margin="4,2" LastChildFill="True" Cursor="Hand">

                                    <Button Content="🗑️"
                        Width="25"
                        Height="25"
                        Margin="0,0,6,0"
                        VerticalAlignment="Center"
                        DockPanel.Dock="Left"
                        Tag="{Binding}"
                        ToolTip="Remove Bookmark"
                        Click="DeleteBookmark_Click"/>

                                    <!-- Table + File Display -->
                                    <TextBlock VerticalAlignment="Center">
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0} • {1}">
                                                <Binding Path="TableName"/>
                                                <Binding Path="DatabasePath" Converter="{StaticResource FileNameConverter}"/>
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>

                                </DockPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>
            </Border>

            <!-- Data Display -->
            <Border Grid.Column="1"
                    Background="White"
                    BorderBrush="#bdc3c7"
                    BorderThickness="1"
                    CornerRadius="5"
                    Padding="5" Grid.ColumnSpan="4">
                <DataGrid x:Name="DataGridDisplay"
                  AutoGenerateColumns="True"
                  EnableRowVirtualization="True"
                  EnableColumnVirtualization="True"
                  VirtualizingPanel.IsVirtualizing="True"
                  VirtualizingPanel.VirtualizationMode="Recycling"
                  ScrollViewer.CanContentScroll="True"
                  AlternatingRowBackground="#f9f9f9"
                  RowBackground="White"
                  BorderThickness="0"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserReorderColumns="True"
                  CanUserResizeColumns="True"
                  CanUserResizeRows="False"
                  CanUserSortColumns="True"/>
            </Border>
        </Grid>
    </Grid>
</Window>